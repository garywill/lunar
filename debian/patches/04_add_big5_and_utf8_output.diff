Description: Add Big5 and UTF-8 output options for lunar.c
 Big5 support was added to 2.2-1 in 2002.
 .
 UTF-8 support was added to 2.2-3 at the request of LI Daobing in 2006,
 see Debian Bug#288170.  However, it could only print simplified Chinese
 in UTF-8 mode back then.
 .
 In 2013, two new options, -s and -t, were added to 2.2-4 so that the
 end-user may choose either simplified or traditional Chinese in UTF-8 mode.
Author: Anthony Fok <foka@debian.org>
Origin: vendor
Bug-Debian: http://bugs.debian.org/288170
Last-Update: 2013-10-04
---
This patch header follows DEP-3: http://dep.debian.net/deps/dep3/
--- a/lunar.c
+++ b/lunar.c
@@ -112,6 +112,31 @@ static char *weekday[] = {
     "Thursday", "Friday", "Saturday"
 };
 
+static	char	*GanUTF8[] = {
+    "ç”²", "ä¹™", "ä¸™", "ä¸", "æˆŠ",
+    "å·±", "åºš", "è¾›", "å£¬", "ç™¸"
+};
+
+static	char	*ZhiUTF8[] = {
+    "å­", "ä¸‘", "å¯…", "å¯", "è¾°", "å·³",
+    "åˆ", "æœª", "ç”³", "é…‰", "æˆŒ", "äº¥"
+};
+
+static	char   *ShengXiaoUTF8_hant[] = {
+    "é¼ ", "ç‰›", "è™", "å…”", "é¾", "è›‡",
+    "é¦¬", "ç¾Š", "çŒ´", "é›", "ç‹—", "è±¬"
+};
+
+static	char   *ShengXiaoUTF8_hans[] = {
+    "é¼ ", "ç‰›", "è™", "å…”", "é¾™", "è›‡",
+    "é©¬", "ç¾Š", "çŒ´", "é¸¡", "ç‹—", "çŒª"
+};
+
+static char *weekdayUTF8[] = {
+    "æ—¥", "ä¸€", "äºŒ", "ä¸‰",
+    "å››", "äº”", "å…­"
+};
+
 static	char	*GanGB[] = {
     "¼×", "ÒÒ", "±û", "¶¡", "Îì",
     "¼º", "¸ı", "ĞÁ", "ÈÉ", "¹ï"
@@ -132,6 +157,26 @@ static char *weekdayGB[] = {
     "ËÄ", "Îå", "Áù"
 };
 
+static	char	*GanB5[] = {
+    "¥Ò", "¤A", "¤ş", "¤B", "¥³",
+    "¤v", "©°", "¨¯", "¤Ğ", "¬Ñ"
+};
+
+static	char	*ZhiB5[] = {
+    "¤l", "¤¡", "±G", "¥f", "¨°", "¤x",
+    "¤È", "¥¼", "¥Ó", "¨»", "¦¦", "¥è"
+};
+
+static	char   *ShengXiaoB5[] = {
+    "¹«", "¤û", "ªê", "¨ß", "Às", "³D",
+    "°¨", "¦Ï", "µU", "Âû", "ª¯", "½Ş"
+};
+
+static char *weekdayB5[] = {
+    "¤é", "¤@", "¤G", "¤T",
+    "¥|", "¤­", "¤»"
+};
+
 
 Date solar, lunar, gan, zhi, gan2, zhi2, lunar2;
 
@@ -140,8 +185,11 @@ int yday[Nyear];	/* number of lunar days
 int mday[Nmonth+1];	/* number of days in the months of the lunar year */
 int jieAlert;		/* if there is uncertainty in JieQi calculation */
 
-int	showHZ = 0;			/* output in hanzi */
+int	showHZ_GB = 0;			/* output in GB-encoded hanzi */
 int	showBM = 0;			/* output in bitmap */
+int	showHZ_UTF8 = 0;		/* output in UTF-8-encoded hanzi */
+int	showHZ_B5 = 0;			/* output in Big5-encoded hanzi */
+int	simplified = 0;			/* output in simplified Chinese */
 char	BMfile[] = "/usr/share/lunar/lunar.bitmap";	/* bit map file */
 char	GZBM[NBM][BMRow][BMCol];	/* the bitmap array */
 char	*progname;
@@ -153,7 +201,8 @@ int     make_yday(), make_mday(), GZcycl
 void	CalGZ();
 int	CmpDate(), JieDate();
 void    readBM(), display3();
-void	Report(), ReportE(), ReportBM(), ReportGB();
+void	Report(), ReportE(), ReportBM(), ReportGB(), ReportB5();
+void	ReportUTF8_hant(), ReportUTF8_hans();
 void	usage(), Error();
 
 
@@ -174,8 +223,45 @@ char *argv[];
 	{
 	    case 'i': inverse = 1; break;
 	    case 'l': if (inverse) leap=1; else usage(); break;
-	    case 'h': showHZ = 1; break;
-	    case 'b': showBM = 1; break;
+	    case 'g':
+	    case 'h': showHZ_GB = 1;
+		      showHZ_UTF8 = showHZ_B5 = 0;
+		      break;
+	    case 'b': showBM = 1;
+		      showHZ_UTF8 = showHZ_GB = showHZ_B5 = 0;
+		      break;
+	    case 'u': showHZ_UTF8 = 1;
+		      showHZ_B5 = showHZ_GB = 0;
+		      break;
+	    case '5': showHZ_B5 = 1;
+		      showHZ_UTF8 = showHZ_GB = 0;
+		      break;
+	    case 's': simplified = 1; break;
+	    case 't': simplified = 0; break;
+	    case '-':
+		if (!strcmp(argv[k], "--utf8"))
+		{
+		    showHZ_UTF8 = 1;
+		    showHZ_B5 = 0;
+		    showHZ_GB = 0;
+		}
+		else if (!strcmp(argv[k], "--big5"))
+		{
+		    showHZ_B5 = 1;
+		    showHZ_UTF8 = 0;
+		    showHZ_GB = 0;
+		}
+		else if (!strcmp(argv[k], "--gb"))
+		{
+		    showHZ_GB = 1;
+		    showHZ_UTF8 = 0;
+		    showHZ_B5 = 0;
+		}
+		else if (!strcmp(argv[k], "--help"))
+		    usage();
+		else
+		    usage();
+		break;
 	    default:  usage(); break;
 	}
     }
@@ -230,12 +316,16 @@ void usage()
     printf("Usage:\n\n");
     printf("Solar->Lunar:\t%s [-h] [-b] year month day [hour]\n", progname);
     printf("\t\t(in Solar Calendar, 24 hour clock)\n\n");
-    printf("Lunar->Solar:\t%s [-h] [-b] -i [-l] year month day [hour]\n",
+    printf("Lunar->Solar:\t%s [-u] [-h] [-b] -i [-l] year month day [hour]\n",
 	   progname);
     printf("\t\t(in Lunar Calendar, 24 hour clock)\n");
-    printf("\t\t-l means the month is a leap month (\"run4 yue4\")\n\n");
-    printf("\t\t-h means output in hanzi (GB)\n");
-    printf("\t\t-b means output in \"bitmap\"\n\n");
+    printf("\t\t-l  means the month is a leap month (\"run4 yue4\")\n\n");
+    printf("\t\t-u, --utf8  means output in hanzi (UTF-8)\n");
+    printf("\t\t        -s  selects simplified Chinese for UTF-8\n");
+    printf("\t\t        -t  selects traditional Chinese for UTF-8\n");
+    printf("\t\t-h, --gb    means output in hanzi (GB)\n");
+    printf("\t\t-5, --big5  means output in hanzi (Big5)\n\n");
+    printf("\t\t-b          means output in \"bitmap\"\n");
     printf("Date range: about %d years from the Solar Date %d.%d.%d\n", Nyear,
 	   SolarFirstDate.year, SolarFirstDate.month, SolarFirstDate.day);
     exit(1);
@@ -586,7 +676,16 @@ int year;
 
 void Report()
 {
-    if (showHZ)
+    if (showHZ_UTF8)
+    {
+	if (simplified)
+	    ReportUTF8_hans();
+	else
+	    ReportUTF8_hant();
+    }
+    else if (showHZ_B5)
+	ReportB5();
+    else if (showHZ_GB)
 	ReportGB();
     else if (showBM)
 	ReportBM();
@@ -595,6 +694,72 @@ void Report()
 }
 
 
+void ReportUTF8_hant()
+{
+    printf("%s%d%s%2d%s%2d%s%2d%s%s%s\n", "é™½æ›†ï¼šã€€",
+	   solar.year, "å¹´", solar.month, "æœˆ", solar.day,
+	   "æ—¥", solar.hour, "æ™‚ã€€",
+	   "æ˜ŸæœŸ", weekdayUTF8[solar.weekday]);
+    printf("%s%d%s%s%2d%s%2d%s%s%s%s%s\n", "é™°æ›†ï¼šã€€",
+	   lunar.year, "å¹´", (lunar.leap? "é–":""),
+	   lunar.month, "æœˆ", lunar.day, "æ—¥",
+	   ZhiUTF8[zhi.hour], "æ™‚ã€€",
+	   "ç”Ÿè‚–å±¬", ShengXiaoUTF8_hant[zhi.year]);
+    printf("%s%s%s%s%s%s%s%s%s%s%s%s%s\n", "å¹²æ”¯ï¼šã€€",
+	   GanUTF8[gan.year], ZhiUTF8[zhi.year], "å¹´ã€€",
+	   GanUTF8[gan.month], ZhiUTF8[zhi.month], "æœˆã€€",
+	   GanUTF8[gan.day], ZhiUTF8[zhi.day], "æ—¥ã€€",
+	   GanUTF8[gan.hour], ZhiUTF8[zhi.hour], "æ™‚ã€€");
+    printf("%s%s%s%s%s%s%s%s%s%s%s%s%s\n",
+	   "ç”¨å››æŸ±ç¥ç®—æ¨ç®—ä¹‹æ™‚è¾°å…«å­—ï¼šã€€",
+	   GanUTF8[gan2.year], ZhiUTF8[zhi2.year], "å¹´ã€€",
+	   GanUTF8[gan2.month], ZhiUTF8[zhi2.month], "æœˆã€€",
+	   GanUTF8[gan2.day], ZhiUTF8[zhi2.day], "æ—¥ã€€",
+	   GanUTF8[gan2.hour], ZhiUTF8[zhi2.hour], "æ™‚ã€€");
+    if (jieAlert)
+    {
+	printf("* %s, %s\n", "æ˜¯æ—¥ç‚ºç¯€",
+	       "æœˆæŸ±å¯èƒ½è¦ä¿®æ”¹");
+	if (lunar2.month==1)
+	    printf("* %s\n", "å¹´æŸ±äº¦å¯èƒ½è¦ä¿®æ”¹");
+	printf("* %s\n", "è«‹æŸ¥æœ‰ç¯€æ°£æ™‚é–“ä¹‹è¬å¹´æ›†");
+    }
+}
+
+
+void ReportUTF8_hans()
+{
+    printf("%s%d%s%2d%s%2d%s%2d%s%s%s\n", "é˜³å†ï¼šã€€",
+	   solar.year, "å¹´", solar.month, "æœˆ", solar.day,
+	   "æ—¥", solar.hour, "æ—¶ã€€",
+	   "æ˜ŸæœŸ", weekdayUTF8[solar.weekday]);
+    printf("%s%d%s%s%2d%s%2d%s%s%s%s%s\n", "é˜´å†ï¼šã€€",
+	   lunar.year, "å¹´", (lunar.leap? "é—°":""),
+	   lunar.month, "æœˆ", lunar.day, "æ—¥",
+	   ZhiUTF8[zhi.hour], "æ—¶ã€€",
+	   "ç”Ÿè‚–å±", ShengXiaoUTF8_hans[zhi.year]);
+    printf("%s%s%s%s%s%s%s%s%s%s%s%s%s\n", "å¹²æ”¯ï¼šã€€",
+	   GanUTF8[gan.year], ZhiUTF8[zhi.year], "å¹´ã€€",
+	   GanUTF8[gan.month], ZhiUTF8[zhi.month], "æœˆã€€",
+	   GanUTF8[gan.day], ZhiUTF8[zhi.day], "æ—¥ã€€",
+	   GanUTF8[gan.hour], ZhiUTF8[zhi.hour], "æ—¶ã€€");
+    printf("%s%s%s%s%s%s%s%s%s%s%s%s%s\n",
+	   "ç”¨å››æŸ±ç¥ç®—æ¨ç®—ä¹‹æ—¶è¾°å…«å­—ï¼šã€€",
+	   GanUTF8[gan2.year], ZhiUTF8[zhi2.year], "å¹´ã€€",
+	   GanUTF8[gan2.month], ZhiUTF8[zhi2.month], "æœˆã€€",
+	   GanUTF8[gan2.day], ZhiUTF8[zhi2.day], "æ—¥ã€€",
+	   GanUTF8[gan2.hour], ZhiUTF8[zhi2.hour], "æ—¶ã€€");
+    if (jieAlert)
+    {
+	printf("* %s, %s\n", "æ˜¯æ—¥ä¸ºèŠ‚",
+	       "æœˆæŸ±å¯èƒ½è¦ä¿®æ”¹");
+	if (lunar2.month==1)
+	    printf("* %s\n", "å¹´æŸ±äº¦å¯èƒ½è¦ä¿®æ”¹");
+	printf("* %s\n", "è¯·æŸ¥æœ‰èŠ‚æ°”æ—¶é—´ä¹‹ä¸‡å¹´å†");
+    }
+}
+
+
 void ReportGB()
 {
     printf("%s%d%s%2d%s%2d%s%2d%s%s%s\n", "ÑôÀú£º¡¡",
@@ -627,6 +792,39 @@ void ReportGB()
     }
 }
 
+
+void ReportB5()
+{
+    printf("%s%d%s%2d%s%2d%s%2d%s%s%s\n", "¶§¾ä¡G¡@",
+	   solar.year, "¦~", solar.month, "¤ë", solar.day,
+	   "¤é", solar.hour, "®É¡@",
+	   "¬P´Á", weekdayB5[solar.weekday]);
+    printf("%s%d%s%s%2d%s%2d%s%s%s%s%s\n", "³±¾ä¡G¡@",
+	   lunar.year, "¦~", (lunar.leap? "¶|":""),
+	   lunar.month, "¤ë", lunar.day, "¤é",
+	   ZhiB5[zhi.hour], "®É¡@",
+	   "¥Í¨vÄİ", ShengXiaoB5[zhi.year]);
+    printf("%s%s%s%s%s%s%s%s%s%s%s%s%s\n", "¤z¤ä¡G¡@",
+	   GanB5[gan.year], ZhiB5[zhi.year], "¦~¡@",
+	   GanB5[gan.month], ZhiB5[zhi.month], "¤ë¡@",
+	   GanB5[gan.day], ZhiB5[zhi.day], "¤é¡@",
+	   GanB5[gan.hour], ZhiB5[zhi.hour], "®É¡@");
+    printf("%s%s%s%s%s%s%s%s%s%s%s%s%s\n",
+	   "¥Î¥|¬W¯«ºâ±Àºâ¤§®É¨°¤K¦r¡G¡@",
+	   GanB5[gan2.year], ZhiB5[zhi2.year], "¦~¡@",
+	   GanB5[gan2.month], ZhiB5[zhi2.month], "¤ë¡@",
+	   GanB5[gan2.day], ZhiB5[zhi2.day], "¤é¡@",
+	   GanB5[gan2.hour], ZhiB5[zhi2.hour], "®É¡@");
+    if (jieAlert)
+    {
+	printf("* %s, %s\n", "¬O¤é¬°¸`",
+	       "¤ë¬W¥i¯à­n­×§ï");
+	if (lunar2.month==1)
+	    printf("* %s\n", "¦~¬W¥ç¥i¯à­n­×§ï");
+	printf("* %s\n", "½Ğ¬d¦³¸`®ğ®É¶¡¤§¸U¦~¾ä");
+    }
+}
+
 
 void ReportE()
 {
